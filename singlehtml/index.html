

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data visualization using Python and Vega-Altair documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_lesson.css" />
      <link rel="stylesheet" type="text/css" href="_static/term_role_formatting.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css" />
      <link rel="stylesheet" type="text/css" href="_static/style.css" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js"></script>
      <script src="_static/doctools.js"></script>
      <script src="_static/sphinx_highlight.js"></script>
      <script src="_static/clipboard.min.js"></script>
      <script src="_static/copybutton.js"></script>
      <script src="_static/minipres.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="_static/togglebutton.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="_static/tabs.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Data visualization using Python and Vega-Altair
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Episodes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-jupyter">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-python-basics">Python basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-plotting">Plotting with Vega-Altair</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-tidy-data">Tidy data and dealing with messy data</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-customizing-plots">Customizing plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-gallery">Learning how to adapt existing gallery examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-sharing">Sharing plots and notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-installation">Software install instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-colab">Going through the course using Google Colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Leftover from previous versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-parsing-custom-format">Reading data in custom format</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Data visualization using Python and Vega-Altair</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Data visualization using Python and Vega-Altair  documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/data-visualization-python/blob/main/content/index" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-visualization-using-python-and-vega-altair">
<h1>Data visualization using Python and Vega-Altair<a class="headerlink" href="#data-visualization-using-python-and-vega-altair" title="Link to this heading"></a></h1>
<p>In this introductory-level workshop, we will learn to produce <strong>reproducible
data visualization pipelines using the Python programming language</strong> and the
<a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a> declarative visualization library.</p>
<p>We will work in <a class="reference external" href="https://jupyter.org/">Jupyter Notebooks</a> and start with
<strong>Python basics</strong>.  We will introduce the <a class="reference external" href="https://pandas.pydata.org/">pandas</a>
library for “data wrangling” (reading, writing, sorting, and filtering of
data).  With pandas, we will be able to read data from Excel sheets and
comma-separated values (CSV) files.</p>
<p>Finally, will learn how to produce
and share <strong>reproducible plots</strong> using
<a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a>.</p>
<section id="who-is-the-course-for">
<h2>Who is the course for?<a class="headerlink" href="#who-is-the-course-for" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Somebody starting with Python or curious about Python.</p></li>
<li><p>Somebody who needs
to read, process, and plot data for their work or studies and would like to
try it out with Python.</p></li>
<li><p>Persons who already use Python for this but want to learn about libraries
to simplify common tasks and about how to share their workflow in a reproducible way.</p></li>
</ul>
<div class="admonition-preparations prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Preparations</p>
<ul class="simple">
<li><p>No programming language experience needed, we will start from zero and learn the basics together</p></li>
<li><p>Computer with network access</p></li>
<li><p><a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a></p></li>
<li><p>Bring one of your recent plotting tasks or challenges</p></li>
</ul>
</div>
</section>
<section id="what-is-not-taught">
<h2>What is not taught?<a class="headerlink" href="#what-is-not-taught" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Version control. Although super useful it is outside of this workshop.</p></li>
<li><p>Python outside a Jupyter Notebook.</p></li>
<li><p><strong>Running the examples in VS Code or Spyder might not be possible</strong>. Please use Jupyter Notebooks for this course.</p></li>
<li><p>Python sets and tuples are only mentioned.</p></li>
<li><p>File input/output is only used via libraries and doing “own” file-I/O is only part
of optional material.</p></li>
<li><p>How to choose the right visualization format for the data at hand.</p></li>
<li><p>Python object oriented design.</p></li>
<li><p>Python packaging.</p></li>
<li><p>NumPy arrays.</p></li>
<li><p>Managing environments and installing Python packages.</p></li>
</ul>
</section>
<section id="episode-overview">
<span id="id1"></span><h2>Episode overview<a class="headerlink" href="#episode-overview" title="Link to this heading"></a></h2>
<p>Day 1 morning:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a></p></li>
<li><p><a class="reference internal" href="#document-jupyter"><span class="doc">Jupyter Notebooks</span></a>
<a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/first-notebook.ipynb"><img alt="nbviewer badge" src="https://img.shields.io/badge/view%20on-nbviewer-brightgreen.svg" /></a>
<a class="reference external" href="https://colab.research.google.com/github/coderefinery/data-visualization-python/blob/main/notebooks/first-notebook.ipynb"><img alt="colab badge" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external" href="https://mybinder.org/v2/gh/coderefinery/data-visualization-python/HEAD?labpath=notebooks%2Ffirst-notebook.ipynb"><img alt="binder badge" src="https://mybinder.org/badge_logo.svg" /></a></p></li>
<li><p><a class="reference internal" href="#document-python-basics"><span class="doc">Python basics</span></a></p></li>
<li><p><a class="reference internal" href="#document-plotting"><span class="doc">Plotting with Vega-Altair</span></a>
<a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/plotting.ipynb"><img alt="nbviewer badge" src="https://img.shields.io/badge/view%20on-nbviewer-brightgreen.svg" /></a>
<a class="reference external" href="https://colab.research.google.com/github/coderefinery/data-visualization-python/blob/main/notebooks/plotting.ipynb"><img alt="colab badge" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external" href="https://mybinder.org/v2/gh/coderefinery/data-visualization-python/HEAD?labpath=notebooks%2Fplotting.ipynb"><img alt="binder badge" src="https://mybinder.org/badge_logo.svg" /></a></p></li>
</ul>
<p>Day 1 afternoon:</p>
<ul class="simple">
<li><p>More <a class="reference internal" href="#document-plotting"><span class="doc">Plotting with Vega-Altair</span></a></p></li>
<li><p><a class="reference internal" href="#document-tidy-data"><span class="doc">Tidy data and dealing with messy data</span></a></p></li>
</ul>
<p>Day 2 morning:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#document-customizing-plots"><span class="doc">Customizing plots</span></a>
<a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/customizing.ipynb"><img alt="nbviewer badge" src="https://img.shields.io/badge/view%20on-nbviewer-brightgreen.svg" /></a>
<a class="reference external" href="https://colab.research.google.com/github/coderefinery/data-visualization-python/blob/main/notebooks/customizing.ipynb"><img alt="colab badge" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external" href="https://mybinder.org/v2/gh/coderefinery/data-visualization-python/HEAD?labpath=notebooks%2Fcustomizing.ipynb"><img alt="binder badge" src="https://mybinder.org/badge_logo.svg" /></a></p></li>
<li><p><a class="reference internal" href="#document-gallery"><span class="doc">Learning how to adapt existing gallery examples</span></a></p></li>
</ul>
<p>Day 3 morning:</p>
<ul class="simple">
<li><p>How to find help and how to navigate the documentation</p></li>
<li><p><a class="reference internal" href="#document-sharing"><span class="doc">Sharing plots and notebooks</span></a></p></li>
</ul>
<div class="toctree-wrapper compound">
<span id="document-jupyter"></span><section id="jupyter-notebooks">
<h3>Jupyter Notebooks<a class="headerlink" href="#jupyter-notebooks" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know what it is</p></li>
<li><p>Create a new notebook and save it</p></li>
<li><p>Open existing notebooks from the web</p></li>
<li><p>Be able to create text/markdown cells, code cells, images, and equations</p></li>
<li><p>Know when to use a Jupyter Notebook for a Python project and when perhaps not to</p></li>
<li><p>We will build up
<a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/first-notebook.ipynb">this notebook</a>
(spoiler alert!)</p></li>
</ul>
</div>
<p>[this lesson is adapted from <a class="reference external" href="https://coderefinery.github.io/jupyter/motivation/">https://coderefinery.github.io/jupyter/motivation/</a>]</p>
<section id="motivation-for-jupyter-notebooks">
<h4>Motivation for Jupyter Notebooks<a class="headerlink" href="#motivation-for-jupyter-notebooks" title="Link to this heading"></a></h4>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/medicean-stars.png"><img alt="Galileo's drawings of Jupiter and its Medicean Stars from Sidereus Nuncius" src="_images/medicean-stars.png" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>One of the first notebooks: Galileo’s drawings of Jupiter and its Medicean
Stars</strong> from Sidereus Nuncius. Image courtesy of the History of Science
Collections, University of Oklahoma Libraries (CC-BY).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Code, text, equations, figures, plots</strong>, etc. are interleaved, creating a <em>computational narrative</em>.</p></li>
<li><p><a class="reference external" href="https://www.nature.com/articles/d41586-018-07196-1"><em>“an environment in which users execute code, see what happens, modify and
repeat in a kind of iterative conversation between researcher and
data”</em></a></p></li>
<li><p>The name “Jupyter” derives from Julia+Python+R, but today Jupyter kernels
exist for <a class="reference external" href="https://github.com/jupyter/jupyter/wiki/Jupyter-kernels">dozens of programming languages</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/jupyter/jupyter/wiki">Gallery of interesting Jupyter Notebooks</a>.</p></li>
</ul>
</section>
<section id="our-first-notebook">
<h4>Our first notebook<a class="headerlink" href="#our-first-notebook" title="Link to this heading"></a></h4>
<div class="admonition-exercise-jupyter-1-create-a-notebook-15-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise Jupyter-1: Create a notebook (15 min)</p>
<ul>
<li><p>Open a new notebook (on Windows: open Anaconda Navigator, then launch JupyterLab; on macOS/Linux: you can open JupyterLab from the terminal by typing <code class="docutils literal notranslate"><span class="pre">jupyter-lab</span></code>)</p></li>
<li><p>Rename the notebook</p></li>
<li><p>Create a <strong>markdown cell</strong> with a section title, a short text, an image, and an equation</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Title of my notebook</span>

Some text.

![<span class="nt">Photo of Galilei&#39;s manuscript</span>](<span class="na">https://upload.wikimedia.org/wikipedia/commons/b/b3/Galileo_Galilei_%281564_-_1642%29_-_Serenissimo_Principe_-_manuscript_with_observations_of_Jupiter_and_four_of_its_moons%2C_1610.png</span>)

$E = mc^2$
</pre></div>
</div>
</li>
<li><p>Most important shortcut: <strong>Shift + Enter</strong>, to run current cell and create a new one below.</p></li>
<li><p>Create a <strong>code cell</strong> where you define the <code class="docutils literal notranslate"><span class="pre">arithmetic_mean</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>
</pre></div>
</div>
</li>
<li><p>In a different cell, call the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">arithmetic_mean</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>In a new cell, let us try to plot a layered histogram:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this example is from https://altair-viz.github.io/gallery/layered_histogram.html</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generating Data</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Trial A&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Trial B&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Trial C&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="p">})</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">transform_fold</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Trial A&#39;</span><span class="p">,</span> <span class="s1">&#39;Trial B&#39;</span><span class="p">,</span> <span class="s1">&#39;Trial C&#39;</span><span class="p">],</span>
    <span class="n">as_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Experiment&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">binSpacing</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;Measurement:Q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;count()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;Experiment:N&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Run all cells.</p></li>
<li><p>Save the notebook.</p></li>
<li><p>Observe that a “#” character has a different meaning in a code cell (code
comment) than in a markdown cell (heading).</p></li>
<li><p>Your notebook should look like <a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/first-notebook.ipynb">this one</a>.</p></li>
</ul>
</div>
</section>
<section id="use-cases-for-notebooks">
<h4>Use cases for notebooks<a class="headerlink" href="#use-cases-for-notebooks" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Really good for step-by-step recipes (e.g. read data, filter data, do some statistics, plot the results)</p></li>
<li><p>Experimenting with new ideas, testing new libraries/databases</p></li>
<li><p>As an <em>interactive</em> development environment for code, data analysis, and visualization</p></li>
<li><p>Keeping track of interactive sessions, like a <strong>digital lab notebook</strong></p></li>
<li><p><strong>Supplementary information with published articles</strong></p></li>
</ul>
</section>
<section id="good-practices">
<h4>Good practices<a class="headerlink" href="#good-practices" title="Link to this heading"></a></h4>
<p><strong>Run all cells</strong> or even <strong>Restart Kernel and Run All Cells</strong>
before sharing/saving to verify that the results you see on your
computer were not due to cells being run out of order.</p>
<p>This can be demonstrated with the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
<p>We can first split this code into two cells and then re-define <code class="docutils literal notranslate"><span class="pre">numbers</span></code>
further down in the notebook. If we run the cells out of order, the result will
be different.</p>
</section>
</section>
<span id="document-python-basics"></span><section id="python-basics">
<h3>Python basics<a class="headerlink" href="#python-basics" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Knowing what types exist</p></li>
<li><p>Knowing the most common data structures: lists, tuples, dictionaries, and sets</p></li>
<li><p>Creating and using functions</p></li>
<li><p>Knowing what a library is</p></li>
<li><p>Knowing what <code class="docutils literal notranslate"><span class="pre">import</span></code> does</p></li>
<li><p>Being able to “read” an error</p></li>
</ul>
</div>
<section id="motivation-for-python">
<h4>Motivation for Python<a class="headerlink" href="#motivation-for-python" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Free</strong></p></li>
<li><p>Huge <strong>ecosystem of examples, libraries, and tools</strong></p></li>
<li><p>Relatively easy to read and understand</p></li>
<li><p>Similar in scope and use cases to R, Julia, and Matlab</p></li>
</ul>
</section>
<section id="basic-types">
<h4>Basic types<a class="headerlink" href="#basic-types" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># int</span>
<span class="n">num_measurements</span> <span class="o">=</span> <span class="mi">13</span>

<span class="c1"># float</span>
<span class="n">some_fraction</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="c1"># string</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bruce Wayne&quot;</span>

<span class="c1"># bool</span>
<span class="n">value_is_missing</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">skip_verification</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># we can print values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># and we can do arithmetics with ints and floats</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">num_measurements</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">some_fraction</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Python is <strong>dynamically typed</strong>:
We do not have to define that an integer is an <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, we can use it this way
and Python will infer it.</p></li>
<li><p>However, one can use <a class="reference external" href="https://docs.python.org/3/library/typing.html">type annotations</a> in Python
(see also <a class="reference external" href="http://mypy-lang.org/">mypy</a>).</p></li>
<li><p>Now you also know that we can add <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">comments</span></code> to our code.</p></li>
</ul>
</section>
<section id="data-structures-for-collections-lists-dictionaries-sets-and-tuples">
<h4>Data structures for collections: lists, dictionaries, sets, and tuples<a class="headerlink" href="#data-structures-for-collections-lists-dictionaries-sets-and-tuples" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># lists are good when order is important</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># first element</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># we can add items to lists</span>
<span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># lists can be sorted</span>
<span class="n">scores</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="c1"># dictionaries are useful if you want to look up</span>
<span class="c1"># elements in a collection by something else than position</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;Svalbard&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-03-23&quot;</span><span class="p">,</span> <span class="s2">&quot;num_measurements&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>

<span class="c1"># we can add items to dictionaries</span>
<span class="n">experiment</span><span class="p">[</span><span class="s2">&quot;instrument&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a particular brand&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>

<span class="k">if</span> <span class="s2">&quot;instrument&quot;</span> <span class="ow">in</span> <span class="n">experiment</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yes, the dictionary &#39;experiment&#39; contains the key &#39;instrument&#39;&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no, it doesn&#39;t&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lists</span></code></a> are good when order is important, and it
needs to be changed</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dictionaries</span></code></a> are mappings key→value.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sets</span></code></a> are useful for unordered collections where you want to make sure that there are no repetitions.</p></li>
<li><p>There are also <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuples</span></code></a> that are similar to lists but their items cannot be modified.</p></li>
</ul>
<p>You can put:</p>
<ul class="simple">
<li><p>dictionaries inside lists</p></li>
<li><p>lists inside dictionaries</p></li>
<li><p>dictionaries inside dictionaries</p></li>
<li><p>lists inside lists</p></li>
<li><p>tuples inside …</p></li>
<li><p>…</p></li>
</ul>
</section>
<section id="iterating-over-collections">
<h4>Iterating over collections<a class="headerlink" href="#iterating-over-collections" title="Link to this heading"></a></h4>
<p>Often we wish to iterate over collections.</p>
<p>Iterating over a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

<span class="c1"># example with f-strings</span>
<span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;the score is </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We don’t have to call the variable inside the for-loop “score”. This is up to us.
We can do this instead (but is this more understandable for humans?):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Iterating over a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;Svalbard&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-03-23&quot;</span><span class="p">,</span> <span class="s2">&quot;num_measurements&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">}</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">experiment</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

<span class="c1"># another way to iterate</span>
<span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h4>
<ul>
<li><p>Functions are like <strong>reusable recipes</strong>. They receive ingredients (input arguments),
then inside the function we do/compute something with these arguments,
and they return a result.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</li>
<li><p>Together we write a function which sums all elements in a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_all_elements</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function adds all elements.</span>
<span class="sd">    This here is a docstring, a documentation string for a function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add_all_elements</span><span class="p">(</span><span class="n">measurements</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>We reuse this function to write a function which computes the mean:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="c1"># we are reusing add_all_elements written above</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">add_all_elements</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>


<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Functions can call other functions. Functions can also get other functions as
input arguments.</p></li>
<li><p>Functions can return more than one thing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">uppercase_and_lowercase</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">l</span>


<span class="n">some_text</span> <span class="o">=</span> <span class="s2">&quot;SequenceOfCharacters&quot;</span>
<span class="n">uppercased_text</span><span class="p">,</span> <span class="n">lowercased_text</span> <span class="o">=</span> <span class="n">uppercase_and_lowercase</span><span class="p">(</span><span class="n">some_text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">uppercased_text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lowercased_text</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>Why functions?</strong> Less repetition but also simplify reading and understanding code.</p>
</section>
<section id="reading-error-messages">
<h4>Reading error messages<a class="headerlink" href="#reading-error-messages" title="Link to this heading"></a></h4>
<p>Here we introduce a mistake and we together try to make sense of the traceback:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/error.png"><img alt="Example error traceback" src="_images/error.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Example error traceback. Can you explain the error?</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="libraries">
<h4>Libraries<a class="headerlink" href="#libraries" title="Link to this heading"></a></h4>
<p>We can look at libraries as collections of functions. We can import the libraries/modules
and then reuse the functions defined inside these libraries.</p>
<p>Try this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>This means <code class="docutils literal notranslate"><span class="pre">numpy</span></code> contains a function called <code class="docutils literal notranslate"><span class="pre">std</span></code> which apparently computes the standard deviation
(check also its <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.std.html">documentation</a>).</p>
<p>Often you see this in tutorials (the module is imported and renamed to a shortcut):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<p>It is possible to create own modules to collect own functions for reuse.</p>
</section>
<section id="great-resources-to-learn-more">
<h4>Great resources to learn more<a class="headerlink" href="#great-resources-to-learn-more" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://realpython.com/">Real Python Tutorials</a> (great for beginners)</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/tutorial/index.html">The Python Tutorial</a> (great for beginners)</p></li>
<li><p><a class="reference external" href="https://docs.python-guide.org/">The Hitchhiker’s Guide to Python!</a> (intermediate level)</p></li>
</ul>
</section>
<section id="exercises">
<h4>Exercises<a class="headerlink" href="#exercises" title="Link to this heading"></a></h4>
<div class="admonition-exercise-create-a-function-that-computes-the-standard-deviation exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: create a function that computes the standard deviation</p>
<ul>
<li><p>Arithmetic mean:</p>
<div class="math notranslate nohighlight">
\[\bar{x} = \frac{1}{N} \sum_{i=1}^N x_i\]</div>
</li>
<li><p>Standard deviation:</p>
<div class="math notranslate nohighlight">
\[\sqrt{ \frac{1}{N} \sum_{i=1}^N (x_i - \bar{x})^2 }\]</div>
</li>
<li><p>In other words the computation is similar but we need to sum over squares of differences and at the end take a square root.</p></li>
<li><p>Take this as a starting point:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we have written this one together previously</span>
<span class="k">def</span> <span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>


<span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="c1"># here we need to do some work:</span>
    <span class="c1"># mean = ?</span>
    <span class="c1"># s = ?</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</li>
<li><p>If this is the input list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>Then the result would be: 2.872…</p>
</li>
</ul>
</div>
<div class="admonition-solution-1-longer-but-hopefully-easier-to-understand solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution 1 (longer but hopefully easier to understand)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we have written this one together previously</span>
<span class="k">def</span> <span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>


<span class="c1"># notice how this function reuses the other</span>
<span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="hll">    <span class="n">mean</span> <span class="o">=</span> <span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</span><span class="hll">    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span class="hll">    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
</span><span class="hll">        <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="n">element</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="admonition-solution-2-more-compact solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution 2 (more compact)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="hll">    <span class="n">mean</span> <span class="o">=</span> <span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</span><span class="hll">    <span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">])</span>
</span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="admonition-exercise-working-with-a-dictionary exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise: working with a dictionary</p>
<ul>
<li><p>We have this dictionary as a starting point:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Alice&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">:</span> <span class="mi">95</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Add the grades of few more (fictious) persons to this dictionary.</p></li>
<li><p>Print the entire dictionary.</p></li>
<li><p>What happens when you add a name which already exists (with a different grade)?</p></li>
<li><p>Print the grade for one particular person only.</p></li>
<li><p>What happens when you try to print the result for a person that wasn’t there?</p></li>
<li><p>Try also these:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>We can add more people like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Craig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">56</span>
<span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Dave&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Eve&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">75</span>
</pre></div>
</div>
<p>Print the entire dictionary with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
</pre></div>
</div>
<p>We get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;Alice&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span> <span class="s1">&#39;Craig&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s1">&#39;Dave&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">}</span>
</pre></div>
</div>
<p>Adding an entry which already exists updates the entry (please try it).</p>
<p>Printing the result for one particular person:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Eve&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Printing the result for a person which does not exists, gives a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<p>The outputs of these three:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>
</div>
<p>… are either the only the keys or only the values, or in the case of <code class="docutils literal notranslate"><span class="pre">items()</span></code>,
key-value pairs (tuples):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Craig&#39;</span><span class="p">,</span> <span class="s1">&#39;Dave&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">])</span>
<span class="n">dict_values</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
<span class="n">dict_items</span><span class="p">([(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Craig&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Dave&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<p>The exercises below use
<a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html#if-statements">if-statements</a>.</p>
<div class="admonition-optional-exercise-homework-removing-duplicates exercise important admonition" id="exercise-2">
<p class="admonition-title">Optional exercise/ homework: removing duplicates</p>
<ul>
<li><p>This list contains duplicates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Write a function which removes duplicates from the list and sorts the list.
In this case it would produce:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition-solution-1-longer-but-hopefully-easier-to-understand solution important dropdown admonition" id="solution-3">
<p class="admonition-title">Solution 1 (longer but hopefully easier to understand)</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">sorted</span></code> sorts a sequence but it creates a new sequence.
This is useful if you need a sorted result without changing the original sequence.</p>
<p>We could have achieved the same result with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list.sort" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list.sort()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remove_duplicates_and_sort</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">new_sequence</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_sequence</span><span class="p">:</span>
            <span class="n">new_sequence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_sequence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-solution-2-more-compact solution important dropdown admonition" id="solution-4">
<p class="admonition-title">Solution 2 (more compact)</p>
<p>Converting to set removes duplicates.
Then we convert back to list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remove_duplicates_and_sort</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">new_sequence</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_sequence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-optional-exercise-homework-counting-how-often-an-item-appears exercise important admonition" id="exercise-3">
<p class="admonition-title">Optional exercise/ homework: counting how often an item appears</p>
<ul>
<li><p>Back to our list with duplicates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Your goal is to write a function which will return a dictionary mapping each
number to how often it appears.
In this case it would produce:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition-solution-1-longer-but-hopefully-easier-to-understand solution important dropdown admonition" id="solution-5">
<p class="admonition-title">Solution 1 (longer but hopefully easier to understand)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">how_often</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="admonition-solution-2-more-compact solution important dropdown admonition" id="solution-6">
<p class="admonition-title">Solution 2 (more compact)</p>
<p>The point of this solution is to show that
for such common operations, ready-made functions and objects
already exist and is is worth to check out the documentation
about the <a class="reference external" href="https://docs.python.org/3/library/collections.html">collections module</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>


<span class="k">def</span> <span class="nf">how_often_alternative1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">how_often_alternative2</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<span id="document-plotting"></span><section id="plotting-with-vega-altair">
<h3>Plotting with <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a><a class="headerlink" href="#plotting-with-vega-altair" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Be able to create simple plots with Vega-Altair and tweak them</p></li>
<li><p>Know how to look for help</p></li>
<li><p>Reading data with Pandas from disk or a web resource</p></li>
<li><p>Know how to tweak example plots from a gallery for your own purpose</p></li>
<li><p>We will build up
<a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/plotting.ipynb">this notebook</a>
(spoiler alert!)</p></li>
</ul>
</div>
<section id="repeatability-reproducibility">
<h4>Repeatability/reproducibility<a class="headerlink" href="#repeatability-reproducibility" title="Link to this heading"></a></h4>
<p>From <a class="reference external" href="https://clauswilke.com/dataviz/">Claus O. Wilke: “Fundamentals of Data Visualization”</a>:</p>
<blockquote>
<div><p><em>One thing I have learned over the years is that automation is your friend. I
think figures should be autogenerated as part of the data analysis pipeline
(which should also be automated), and they should come out of the pipeline
ready to be sent to the printer, no manual post-processing needed.</em></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Try to minimize manual post-processing</strong>. This could bite you when you need to regenerate 50
figures one day before submission deadline or regenerate a set of figures
after the person who created them left the group.</p></li>
<li><p>There is not the one perfect language and <strong>not the one perfect library</strong> for everything.</p></li>
<li><p>Within Python, many libraries exist:</p>
<ul>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Vega-Altair</a>:
declarative visualization, statistics built in</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/gallery/index.html">Matplotlib</a>:
probably the most standard and most widely used</p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org/examples/index.html">Seaborn</a>:
high-level interface to Matplotlib, statistical functions built in</p></li>
<li><p><a class="reference external" href="https://plotly.com/python/">Plotly</a>:
interactive graphs</p></li>
<li><p><a class="reference external" href="https://demo.bokeh.org/">Bokeh</a>:
also here good for interactivity</p></li>
<li><p><a class="reference external" href="https://plotnine.readthedocs.io/">plotnine</a>:
implementation of a grammar of graphics in Python, it is based on <a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a></p></li>
<li><p><a class="reference external" href="https://yhat.github.io/ggpy/">ggplot</a>:
R users will be more at home</p></li>
<li><p><a class="reference external" href="https://www.pyngl.ucar.edu/Examples/gallery.shtml">PyNGL</a>:
used in the weather forecast community</p></li>
<li><p><a class="reference external" href="https://k3d-jupyter.org/gallery/index.html">K3D</a>:
Jupyter Notebook extension for 3D visualization</p></li>
<li><p><a class="reference external" href="https://docs.enthought.com/mayavi/mayavi/">Mayavi</a>:
3D scientific data visualization and plotting in Python</p></li>
<li><p>…</p></li>
</ul>
</li>
<li><p>Two main families of libraries: procedural (e.g. Matplotlib) and declarative (e.g. Vega-Altair).</p></li>
</ul>
</section>
<section id="why-are-we-starting-with-vega-altair">
<h4>Why are we starting with <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a>?<a class="headerlink" href="#why-are-we-starting-with-vega-altair" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Concise and powerful</p></li>
<li><p>“Simple, friendly and consistent API” allows us to focus on the data
visualization part and get started without too much Python knowledge</p></li>
<li><p>The way it <strong>combines visual channels with data columns</strong> can feel intuitive</p></li>
<li><p>Interfaces very nicely with <a class="reference external" href="https://pandas.pydata.org/">Pandas</a></p></li>
<li><p>Easy to change figures</p></li>
<li><p>Good documentation</p></li>
<li><p>Open source</p></li>
<li><p>Makes it easy to save figures in a number of formats (svg, png, html)</p></li>
<li><p>Easy to save interactive visualizations to be used in websites</p></li>
</ul>
</section>
<section id="example-data-weather-data-from-two-norwegian-cities">
<h4>Example data: Weather data from two Norwegian cities<a class="headerlink" href="#example-data-weather-data-from-two-norwegian-cities" title="Link to this heading"></a></h4>
<p>We will experiment with some example weather data obtained from <a class="reference external" href="https://seklima.met.no/observations/">Norsk
KlimaServiceSenter</a>, Meteorologisk
institutt (MET) (CC BY 4.0).  The data is in CSV format (comma-separated
values) and contains daily and monthly weather data for two cities in Norway:
Oslo and Tromsø. You can browse the data
<a class="reference external" href="https://github.com/coderefinery/data-visualization-python/tree/main/data">here in the lesson repository</a>.</p>
<p>We will use the Pandas library to read the data into a dataframe.</p>
<p>Pandas can read from and write to a large set of formats
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/io.html">overview of input/output functions and formats</a>).
We will load a CSV file directly from the web. Instead of using a web URL we
could use a local file name instead.</p>
<p>Pandas dataframes are a great data structure for <strong>tabular data</strong> and tabular
data turns out to be a great input format for data visualization libraries.
Vega-Altair understands Pandas dataframes and can plot them directly.</p>
</section>
<section id="reading-data-into-a-dataframe">
<h4>Reading data into a dataframe<a class="headerlink" href="#reading-data-into-a-dataframe" title="Link to this heading"></a></h4>
<p>We can try this together in a notebook:
Using Pandas we can <strong>merge, join, concatenate, and compare</strong>
dataframes, see <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html</a>.</p>
<p>Let us try to <strong>concatenate</strong> two dataframes: one for Tromsø weather data (we
will now load monthly values) and one for Oslo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">url_prefix</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/coderefinery/data-visualization-python/main/data/&quot;</span>

<span class="n">data_tromso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;tromso-monthly.csv&quot;</span><span class="p">)</span>
<span class="n">data_oslo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;oslo-monthly.csv&quot;</span><span class="p">)</span>

<span class="hll"><span class="n">data_monthly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_tromso</span><span class="p">,</span> <span class="n">data_oslo</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span>
<span class="c1"># let us print the combined result</span>
<span class="n">data_monthly</span>
</pre></div>
</div>
<p>Before plotting the data, there is a problem which we may not see yet: Dates
are not in a standard date format (YYYY-MM-DD). We can fix this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace mm.yyyy to date format</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%m.%Y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With Pandas it is possible to do a lot more (adjusting missing values, fixing
inconsistencies, changing format).</p>
</section>
<section id="what-is-in-a-dataframe">
<h4>What is in a dataframe?<a class="headerlink" href="#what-is-in-a-dataframe" title="Link to this heading"></a></h4>
<p>The name pandas is derived from the term “<strong>pan</strong>el <strong>da</strong>ta”.</p>
<figure class="align-default" id="id1">
<img alt="A pandas dataframe object is composed of rows and columns." src="_images/dataframe.svg" />
<figcaption>
<p><span class="caption-text">A pandas dataframe object is composed of rows and columns.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let us explore these together in the notebook (run these in separate cells):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># print an overview of the dataset</span>
<span class="n">data_monthly</span>

<span class="c1"># print the first 5 rows</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># print the last 5 rows</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>

<span class="c1"># print all column titles - no parentheses here</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># show which data types were detected</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">dtypes</span>

<span class="c1"># print table dimensions - no parentheses here</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># print one column</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span>

<span class="c1"># get some statistics</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

<span class="c1"># what was the maximum temperature?</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># print all rows where max temperature was above 20</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">20.0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="where-to-learn-more-about-pandas">
<h4>Where to learn more about pandas<a class="headerlink" href="#where-to-learn-more-about-pandas" title="Link to this heading"></a></h4>
<p>Pandas is extremely powerful and there is a lot that can be done and there are
great resources to explore more:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/getting_started.html">Getting started guide</a>
(including tutorials and a 10 minute flash intro)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/10min.html">10 minutes to pandas tutorial</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/">Pandas documentation</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">Cheatsheet</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/cookbook.html#cookbook">Cookbook</a></p></li>
<li><p><a class="reference external" href="https://datacarpentry.org/python-ecology-lesson/">Data Carpentry lesson</a> “Data Analysis and Visualization in Python for Ecologists”
(useful not only for ecologists)</p></li>
</ul>
</section>
<section id="plotting-the-data">
<h4>Plotting the data<a class="headerlink" href="#plotting-the-data" title="Link to this heading"></a></h4>
<p>Now let’s plot the data. We will start with a plot that is not optimal and
then we will explore and improve a bit as we go:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id2">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year." src="_images/precipitation-on-top.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-let-us-pause-and-explain-the-code discussion important admonition" id="discussion-0">
<p class="admonition-title">Let us pause and explain the code</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alt</span></code> is a short-hand for <code class="docutils literal notranslate"><span class="pre">altair</span></code> which we imported on top of the notebook</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Chart()</span></code> is a function defined inside <code class="docutils literal notranslate"><span class="pre">altair</span></code> which takes the data as argument</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mark_bar()</span></code> is a function that produces bar charts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encode()</span></code> is a function which encodes data columns to <strong>visual channels</strong></p></li>
</ul>
<p>Observe how we connect (encode) <strong>visual channels</strong> to data columns:</p>
<ul class="simple">
<li><p>x-coordinate with “date”</p></li>
<li><p>y-coordinate with “precipitation”</p></li>
<li><p>color with “name” (name of weather station; city)</p></li>
</ul>
</div>
<p>We can improve the plot by giving Vega-Altair a bit more information that the
x-axis is <strong>temporal</strong> (T) and that we would like to see the year and
month (yearmonth):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
</span>    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Apart from T (temporal), there are other
<a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/index.html#encoding-data-types">encoding data types</a>:</p>
<ul class="simple">
<li><p>Q (quantitative)</p></li>
<li><p>O (ordinal)</p></li>
<li><p>N (nominal)</p></li>
<li><p>T (temporal)</p></li>
<li><p>G (geojson)</p></li>
</ul>
<figure class="align-default" id="id3">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year." src="_images/precipitation-on-top-yearmonth.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let us improve the plot with another one-line change:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id4">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year with with both cities plotted side by side." src="_images/precipitation-side.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year with with both cities plotted side by side.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>With another one-line change we can make the bar chart stacked:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">xOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id5">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year with with both cities plotted side by side." src="_images/precipitation-stacked-x.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year
plotted as stacked bar chart.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This is not publication-quality yet but a really good start!</p>
<p>Let us try one more example where we can nicely see how Vega-Altair
is able to map visual channels to data columns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
    <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;min temperature&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id6">
<img alt="Monthly temperature ranges for two cities in Norway." src="_images/temperature-ranges-combined.svg" />
<figcaption>
<p><span class="caption-text">Monthly temperature ranges for two cities in Norway.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-what-other-marks-and-other-visual-channels-exist discussion important admonition" id="discussion-1">
<p class="admonition-title">What other marks and other visual channels exist?</p>
<ul class="simple">
<li><p><a class="reference external" href="https://altair-viz.github.io/user_guide/marks/index.html">Overview of available marks</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/channels.html">Overview of available visual channels</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Gallery of examples</a></p></li>
</ul>
</div>
</section>
<section id="exercise-using-visual-channels-to-re-arrange-plots">
<h4>Exercise: Using visual channels to re-arrange plots<a class="headerlink" href="#exercise-using-visual-channels-to-re-arrange-plots" title="Link to this heading"></a></h4>
<div class="admonition-exercise-plotting-1-using-visual-channels-to-re-arrange-plots exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise Plotting-1: Using visual channels to re-arrange plots</p>
<ol class="arabic">
<li><p>Try to reproduce the above plots if they are not already in your notebook.</p></li>
<li><p>Above we have plotted the monthly precipitation for two cities side by side
using a stacked plot. Try to arrive at the following plot where months are
along the y-axis and the precipitation amount is along the x-axis:</p>
<figure class="align-default">
<img alt="_images/precipitation-stacked-y.svg" src="_images/precipitation-stacked-y.svg" />
</figure>
</li>
<li><p>Ask the Internet or AI how to change the axis title from “precipitation”
to “Precipitation (mm)”.</p></li>
<li><p>Modify the temperature range plot to show the temperature ranges for the
two cities side by side like this:</p>
<figure class="align-default">
<img alt="_images/temperature-ranges-side.svg" src="_images/temperature-ranges-side.svg" />
</figure>
</li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ol class="arabic">
<li><p>Copy-paste code blocks from above.</p></li>
<li><p>Basically we switched x and y:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">yOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>This can be done with the following modification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;precipitation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precipitation (mm)&quot;</span><span class="p">),</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">yOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>We added one line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
    <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;min temperature&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</section>
<section id="more-fun-with-visual-channels">
<h4>More fun with visual channels<a class="headerlink" href="#more-fun-with-visual-channels" title="Link to this heading"></a></h4>
<p>Now we will try to <strong>plot the daily data and look at snow depths</strong>. We first
read and concatenate two datasets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">url_prefix</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/coderefinery/data-visualization-python/main/data/&quot;</span>

<span class="n">data_tromso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;tromso-daily.csv&quot;</span><span class="p">)</span>
<span class="n">data_oslo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;oslo-daily.csv&quot;</span><span class="p">)</span>

<span class="n">data_daily</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_tromso</span><span class="p">,</span> <span class="n">data_oslo</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>We adjust the data a bit:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace dd.mm.yyyy to date format</span>
<span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.%m.%Y&quot;</span><span class="p">)</span>

<span class="c1"># we are here only interested in the range december to may</span>
<span class="n">data_daily</span> <span class="o">=</span> <span class="n">data_daily</span><span class="p">[</span>
    <span class="p">(</span><span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s2">&quot;2022-12-01&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="s2">&quot;2023-05-01&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Now we can plot the snow depths for the months December to May for the two
cities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id7">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway." src="_images/snow-depth.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>What happens if we try to color the plot by the “max temperature” values?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
</span>    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The result looks neat:</p>
<figure class="align-default" id="id8">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature." src="_images/snow-depth-color.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We can change the color scheme (<a class="reference external" href="https://vega.github.io/vega/docs/schemes/">available color schemes</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;max temperature&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">),</span>
</span>    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>With the following result:</p>
<figure class="align-default" id="id9">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth." src="_images/snow-depth-plasma.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let’s try one more change to show that we can experiment with different
plot types by changing <code class="docutils literal notranslate"><span class="pre">mark_bar()</span></code> to something else, in this case <code class="docutils literal notranslate"><span class="pre">mark_circle()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span>    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;max temperature&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">),</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id10">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth." src="_images/snow-depth-circles.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="themes">
<h4>Themes<a class="headerlink" href="#themes" title="Link to this heading"></a></h4>
<p>In <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a> you can change the theme and
select from a long <a class="reference external" href="https://github.com/vega/vega-themes">list of themes</a>.  On
top of your notebook try to add:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then re-run all cells. Later you can try some other themes such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fivethirtyeight</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latimes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">urbaninstitute</span></code></p></li>
</ul>
<p>You can even define your own themes!</p>
</section>
<section id="exercise-anscombe-s-quartet">
<h4>Exercise: Anscombe’s quartet<a class="headerlink" href="#exercise-anscombe-s-quartet" title="Link to this heading"></a></h4>
<p>Save the following data as <code class="docutils literal notranslate"><span class="pre">example.csv</span></code> (you can do this directly from
JupyterLab; this data is the <a class="reference external" href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">Anscombe’s
quartet</a>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>dataset,x,y
I,10.0,8.04
I,8.0,6.95
I,13.0,7.58
I,9.0,8.81
I,11.0,8.33
I,14.0,9.96
I,6.0,7.24
I,4.0,4.26
I,12.0,10.84
I,7.0,4.82
I,5.0,5.68
II,10.0,9.14
II,8.0,8.14
II,13.0,8.74
II,9.0,8.77
II,11.0,9.26
II,14.0,8.1
II,6.0,6.13
II,4.0,3.1
II,12.0,9.13
II,7.0,7.26
II,5.0,4.74
III,10.0,7.46
III,8.0,6.77
III,13.0,12.74
III,9.0,7.11
III,11.0,7.81
III,14.0,8.84
III,6.0,6.08
III,4.0,5.39
III,12.0,8.15
III,7.0,6.42
III,5.0,5.73
IV,8.0,6.58
IV,8.0,5.76
IV,8.0,7.71
IV,8.0,8.84
IV,8.0,8.47
IV,8.0,7.04
IV,8.0,5.25
IV,19.0,12.5
IV,8.0,5.56
IV,8.0,7.91
IV,8.0,6.89
</pre></div>
</div>
<div class="admonition-exercise-plotting-2-read-and-plot-a-csv-file exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise Plotting-2: Read and plot a CSV file</p>
<ul class="simple">
<li><p>Save the above CSV file to disk as <code class="docutils literal notranslate"><span class="pre">example.csv</span></code> in the same folder where
you run JupyterLab. We recommend to create the file in the JupyterLab
interface.</p></li>
<li><p>Plot the data using <code class="docutils literal notranslate"><span class="pre">mark_point</span></code>.</p></li>
<li><p>Your goal is to arrive at four plots for the four data sets, all side by side.</p></li>
<li><p>If you have time, try to customize the plot.</p></li>
</ul>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we don&#39;t need to import again but just in case you started here</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;example.csv&quot;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Here is a more advanced example where the four plots are arranged
in a 2 x 2 grid:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_chart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="n">number</span><span class="p">)</span>
        <span class="o">.</span><span class="n">mark_point</span><span class="p">()</span>
        <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">chart</span>


<span class="n">chart1</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">)</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;II&quot;</span><span class="p">)</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;III&quot;</span><span class="p">)</span>
<span class="n">chart4</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;IV&quot;</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">vconcat</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">chart1</span><span class="p">,</span> <span class="n">chart2</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">chart3</span><span class="p">,</span> <span class="n">chart4</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Browse a number of example galleries to help you choose the library
that fits best your work/style.</p></li>
<li><p>Minimize manual post-processing and try to script all steps.</p></li>
<li><p>CSV (comma-separated values) files are often a good format to store the data
that we wish to plot.</p></li>
<li><p>Read the data into a Pandas dataframe and then plot it with Vega-Altair
where you connect data columns to
<a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/channels.html">visual channels</a>.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-tidy-data"></span><section id="tidy-data-and-dealing-with-messy-data">
<h3>Tidy data and dealing with messy data<a class="headerlink" href="#tidy-data-and-dealing-with-messy-data" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Knowing about different storage formats</p></li>
<li><p>Knowing about the tidy data format</p></li>
<li><p>Be able to reformat tabular data into the tidy data format</p></li>
</ul>
</div>
<p>In the previous episode we read data from nicely formatted “plain” text files.
But sometimes the data is in a spreadsheet or in less nicely formatted text files.
In this episode we will discuss strategies for how to work with these.</p>
<section id="importing-data-from-spreadsheets">
<h4>Importing data from spreadsheets<a class="headerlink" href="#importing-data-from-spreadsheets" title="Link to this heading"></a></h4>
<p>We will create a spreadsheet with the following content (only columns A and B;
the actual content does not have to be exactly the same):</p>
<figure class="align-default" id="id1">
<img alt="An example spreadsheet with weekdays in one column and number of coffees in the other" src="_images/coffees.png" />
<figcaption>
<p><span class="caption-text">Example spreadsheet with a side note.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Copy this also to the second sheet and for demonstration purpose
add some side-notes to the second sheet and also color
one or two cells (some people like to give some meaning to cells using color).</p>
<p>Save the spreadsheet as <code class="docutils literal notranslate"><span class="pre">experiment.xls</span></code>.</p>
<p>Now we will together try to read and inspect both sheets in the Jupyter
Notebook:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;experiment.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
<span class="n">data</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;experiment.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet2&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>We can import data from spreadsheets
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html">more documentation</a>)!</p></li>
<li><p>“Side notes” in spreadsheets can be annoying in this context.</p></li>
<li><p>Also encoding data in cell colors is a problem now. We will avoid those in
future.</p></li>
</ul>
</div>
</section>
<section id="tidy-data">
<h4>Tidy data<a class="headerlink" href="#tidy-data" title="Link to this heading"></a></h4>
<figure class="align-default" id="id2">
<img alt="An example spreadsheet not in tidy data format" src="_images/spreadsheet.png" />
<figcaption>
<p><span class="caption-text">Example spreadsheet (this is a phantasy dataset, apologies to biology
students/researchers - this is not my domain).</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-what-is-the-problem-with-storing-data-like-this discussion important admonition" id="discussion-1">
<p class="admonition-title">What is the problem with storing data like this?</p>
<ul class="simple">
<li><p>Format: Limited interoperability with other programs</p></li>
<li><p>Error prone (see e.g. <a class="reference external" href="https://www.washingtonpost.com/news/wonk/wp/2013/04/16/is-the-best-evidence-for-austerity-based-on-an-excel-spreadsheet-error/">this famous example</a>)</p></li>
<li><p>Difficult to parse (“understand”) by scripts: difficult to automate</p></li>
<li><p>Not in <em>tidy format</em>: difficult to extend/modify</p></li>
</ul>
</div>
<p>How should we arrange the data?</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/svalbard-compact.png"><img alt="Example data arranged in a compact representation" src="_images/svalbard-compact.png" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-text">Attempt 1: Not great since we need to somehow divide at the comma. How should we deal with multiple sightings?</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/svalbard-wide.png"><img alt="Example data arranged in a wide format" src="_images/svalbard-wide.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Attempt 2: Adding observation sites will force us to add columns.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/svalbard-transposed.png"><img alt="Example data transposed" src="_images/svalbard-transposed.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Attempt 3: Adding species will force us to add columns.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="_images/svalbard-tidy.png"><img alt="Example data arranged in tidy data format" src="_images/svalbard-tidy.png" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-text">Tidy data format: Columns are variables, rows are observations/measurements. Easy to add new species and sites.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-tidy-data-format keypoints admonition" id="keypoints-0">
<p class="admonition-title">Tidy data format</p>
<ul class="simple">
<li><p><a class="reference external" href="https://vita.had.co.nz/papers/tidy-data.html">Hadley Wickham: Tidy Data</a></p></li>
<li><p>Columns are variables</p></li>
<li><p>Rows are observations/measurements</p></li>
<li><p>“Long form”</p></li>
<li><p>Order does not matter</p></li>
<li><p><strong>Easy to extend</strong> with more species and more sites
without modifying the code</p></li>
<li><p><strong>Structure for storing data</strong> - this does not mean that this is ideal
for tables in presentations or publications</p></li>
<li><p>It is possible to convert between wide form and long form and back
(e.g. using <code class="docutils literal notranslate"><span class="pre">pandas.melt</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.pivot</span></code>), see <a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/tidy-data.ipynb">this example notebook</a></p></li>
</ul>
</div>
</section>
<section id="use-a-standard-format">
<h4>Use a standard format<a class="headerlink" href="#use-a-standard-format" title="Link to this heading"></a></h4>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Species,Observation site,Number of sightings
arctic fox,A,3
arctic fox,B,1
walrus,B,1
walrus,C,1
reindeer,B,10
reindeer,C,1
polar bear,A,1
polar bear,C,1
seal,A,2
seal,B,1
seal,C,2
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Use a format that is standard in your community, don’t invent your own</strong></p></li>
<li><p>CSV is often a good choice since most visualization tools can read CSV data</p></li>
</ul>
<p>There are many more formats (adapted after <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/work-with-data/">Python for Scientific Computing</a>):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name:</p></th>
<th class="head"><p>Human<br>
readable:</p></th>
<th class="head"><p>Space<br>
efficiency:</p></th>
<th class="head"><p>Arbitrary<br>
data:</p></th>
<th class="head"><p>Tidy<br>
data:</p></th>
<th class="head"><p>Array<br>
data:</p></th>
<th class="head"><p>Long term<br>
storage/sharing:</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a></p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>🟨</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://arrow.apache.org/docs/python/feather.html">Feather</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://parquet.apache.org/">Parquet</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>🟨</p></td>
<td><p>✅</p></td>
<td><p>🟨</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.lib.format.html">NPY</a></p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Hierarchical_Data_Format">HDF5</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a></p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://geojson.org/">GeoJSON</a></p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Excel</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
</tr>
<tr class="row-odd"><td><p>Graph formats</p></td>
<td><p>🟨</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/SQL">SQL</a></p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>✅ : Good</p></li>
<li><p>🟨 : Ok / depends on a case</p></li>
<li><p>❌ : Bad</p></li>
</ul>
</div>
</section>
<section id="data-cleaning">
<h4>Data cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading"></a></h4>
<p>Often we want to visualize data sets with inconsistent or missing entries:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Date,Organization,Number of participants
2020-09-27,UiT,20
Oct 10 2020,UiT Norges arktiske universitet,15
&quot;Nov. 11, 2020&quot;,UiT The Arctic University of Norway,40
2020-12-12,UiT The Arctic University of Norway,-
</pre></div>
</div>
<p>Data cleaning is a bit outside the scope of this course
(although we have done some of this in the pandas episode) but still good to know:</p>
<ul class="simple">
<li><p>There are tools to clean and merge inconsistent data sets (e.g. <a class="reference external" href="https://openrefine.org/">OpenRefine</a>, see also
<a class="reference external" href="https://datacarpentry.org/OpenRefine-ecology-lesson/">this Data Carpentry lesson</a>)</p></li>
<li><p>This does not have to be done manually</p></li>
</ul>
</section>
</section>
<span id="document-customizing-plots"></span><section id="customizing-plots">
<h3>Customizing plots<a class="headerlink" href="#customizing-plots" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know where to look to find out how to tweak plots</p></li>
<li><p>Start with a relatively simple example and build up more and more features</p></li>
<li><p>See the process of going from a raw plot towards a publication-ready plot</p></li>
<li><p>We will build up
<a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/customizing.ipynb">this notebook</a>
(spoiler alert!)</p></li>
</ul>
</div>
<section id="loading-and-plotting-a-dataset">
<h4>Loading and plotting a dataset<a class="headerlink" href="#loading-and-plotting-a-dataset" title="Link to this heading"></a></h4>
<p>In this lesson will work with one of the
<a class="reference external" href="https://www.gapminder.org/tools/">Gapminder</a> datasets.</p>
<p>Let us together read and plot the data and then we explain what is happening
and we will improve the figure together.  First we read and inspect the data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import necessary libraries</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># read the data</span>
<span class="n">url_prefix</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/plotly/datasets/master/&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;gapminder_with_codes.csv&quot;</span><span class="p">)</span>

<span class="c1"># print overview of the dataset</span>
<span class="n">data</span>
</pre></div>
</div>
<p>With very few lines we can get the first raw plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id1">
<img alt="First raw plot with all countries and all years." src="_images/all-data.svg" />
<figcaption>
<p><span class="caption-text">First raw plot with all countries and all years.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Observe how we connect (encode) <strong>visual channels</strong> to data columns:</p>
<ul class="simple">
<li><p>x-coordinate with “gdpPercap”</p></li>
<li><p>y-coordinate with “lifeExp”</p></li>
</ul>
<p>The following code would have the same effect but the above version might be
easier to read:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-let-us-pause-and-explain-the-code discussion important admonition" id="discussion-0">
<p class="admonition-title">Let us pause and explain the code</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alt</span></code> is a short-hand for <code class="docutils literal notranslate"><span class="pre">altair</span></code> which we imported on top of the notebook</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Chart()</span></code> is a function defined inside <code class="docutils literal notranslate"><span class="pre">altair</span></code> which takes the data as argument</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mark_point()</span></code> is a function that produces scatter plots</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encode()</span></code> is a function which encodes data columns to visual channels</p></li>
</ul>
</div>
</section>
<section id="filtering-data">
<h4>Filtering data<a class="headerlink" href="#filtering-data" title="Link to this heading"></a></h4>
<p>In <a class="reference external" href="https://altair-viz.github.io">Vega-Altair</a> we can chain functions.  Let us
add two more functions: The first will apply a filter, the second will make the
plot interactive:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span>
<span class="hll"><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></pre></div>
</div>
<figure class="align-default" id="id2">
<img alt="Now we only keep the year 2007." src="_images/only-2007.svg" />
<figcaption>
<p><span class="caption-text">Now we only keep the year 2007.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Alternatively, we could have filtered the data before plotting using pandas.</p>
</section>
<section id="using-color-as-additional-channel">
<h4>Using color as additional channel<a class="headerlink" href="#using-color-as-additional-channel" title="Link to this heading"></a></h4>
<p>A very neat feature of <a class="reference external" href="https://altair-viz.github.io">Vega-Altair</a> is that it
is easy to add and modify visual channels. Let us try to add one more so that
we do something with the “continent” data column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id3">
<img alt="Using different colors for different continents." src="_images/color.svg" />
<figcaption>
<p><span class="caption-text">Using different colors for different continents.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="changing-to-log-scale">
<h4>Changing to log scale<a class="headerlink" href="#changing-to-log-scale" title="Link to this heading"></a></h4>
<p>For this data set we will get a better insight when switching the x-axis from
linear to log scale:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">),</span>
</span><span class="hll">    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">),</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id4">
<img alt="Changing the x axis to log scale." src="_images/log-scale.svg" />
<figcaption>
<p><span class="caption-text">Changing the x axis to log scale.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="improving-axis-titles">
<h4>Improving axis titles<a class="headerlink" href="#improving-axis-titles" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
</span><span class="hll">    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">),</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id5">
<img alt="Improving the axis titles." src="_images/axis-titles.svg" />
<figcaption>
<p><span class="caption-text">Improving the axis titles.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="faceted-charts">
<h4>Faceted charts<a class="headerlink" href="#faceted-charts" title="Link to this heading"></a></h4>
<p>To see what faceted charts are and how easy it is to do this, add the following
line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">row</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<p>Guess what happens when you change <code class="docutils literal notranslate"><span class="pre">row=&quot;continent&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">column=&quot;continent&quot;</span></code>?</p>
</section>
<section id="changing-from-points-to-circles">
<h4>Changing from points to circles<a class="headerlink" href="#changing-from-points-to-circles" title="Link to this heading"></a></h4>
<p>Let us add one more visual channel, mapping size of the circle to the
population size of a country:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span>    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">size</span><span class="o">=</span><span class="s2">&quot;pop&quot;</span><span class="p">,</span>
</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id6">
<img alt="Circle sizes are proportional to population sizes." src="_images/population-size.svg" />
<figcaption>
<p><span class="caption-text">Circle sizes are proportional to population sizes.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="title-and-axis-values">
<h4>Title and axis values<a class="headerlink" href="#title-and-axis-values" title="Link to this heading"></a></h4>
<p>In the next step we modify a number of things:</p>
<ul class="simple">
<li><p>We go back to the version where all circles have the same size</p></li>
<li><p>Add figure title</p></li>
<li><p>Modify axis domains to “zoom into” the interesting part of the plot</p></li>
<li><p>Set axis values</p></li>
<li><p>Change from <code class="docutils literal notranslate"><span class="pre">mark_point()</span></code> to <code class="docutils literal notranslate"><span class="pre">mark_circle()</span></code></p></li>
<li><p>Invoke <code class="docutils literal notranslate"><span class="pre">interactive()</span></code> in a separate step</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Life expectancy as function of the gross domestic product&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">85</span><span class="p">)),</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id7">
<img alt="Plot after adding a figure title." src="_images/with-title.svg" />
<figcaption>
<p><span class="caption-text">The plot is starting to look better!</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="colors">
<h4>Colors<a class="headerlink" href="#colors" title="Link to this heading"></a></h4>
<p>In the next step we change the color scheme (<a class="reference external" href="https://vega.github.io/vega/docs/schemes/">list of all
schemes</a>), make the circles larger
and slightly transparent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Life expectancy as function of the gross domestic product&quot;</span><span class="p">),</span>
    <span class="p">)</span>
<span class="hll">    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
</span>    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">85</span><span class="p">)),</span>
<span class="hll">        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;continent&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;dark2&quot;</span><span class="p">),</span>
</span>    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id8">
<img alt="The plot after adjusting circles and colors." src="_images/dark2.svg" />
<figcaption>
<p><span class="caption-text">The plot after adjusting circles and colors.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We can also define own colors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">okabe_ito</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="hll">    <span class="s2">&quot;#0072b2&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#e69f00&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#cc79a7&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#009e73&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#f0e442&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#d55e00&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s2">&quot;#56b4e9&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="p">]</span>
</span>
<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Life expectancy as function of the gross domestic product&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">85</span><span class="p">)),</span>
<span class="hll">        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;continent&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">okabe_ito</span><span class="p">),</span>
</span>    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id9">
<img alt="Adjusting colors to those recommended by Okabe and Ito." src="_images/okabe-ito.svg" />
<figcaption>
<p><span class="caption-text">Adjusting colors to those recommended by Okabe and Ito.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-why-these-colors discussion important admonition" id="discussion-1">
<p class="admonition-title">Why these colors?</p>
<p>This qualitative color palette is optimized for all color-vision
deficiencies, see <a class="reference external" href="https://clauswilke.com/dataviz/color-pitfalls.html">https://clauswilke.com/dataviz/color-pitfalls.html</a> and
<a class="reference external" href="http://jfly.iam.u-tokyo.ac.jp/color/">Okabe, M., and K. Ito. 2008. “Color Universal Design (CUD):
How to Make Figures and Presentations That Are Friendly to Colorblind People.”</a>.</p>
</div>
</section>
<section id="more-tweaking-towards-a-publication-ready-figure">
<h4>More tweaking towards a publication-ready figure<a class="headerlink" href="#more-tweaking-towards-a-publication-ready-figure" title="Link to this heading"></a></h4>
<p>Let us add a subtitle and adjust sizing and positioning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">&quot;Life expectancy as function of the gross domestic product&quot;</span><span class="p">,</span>
<span class="hll">            <span class="n">subtitle</span><span class="o">=</span><span class="p">[</span>
</span><span class="hll">                <span class="s2">&quot;Gross domestic product (GDP) per capita measures the value of everything&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="s2">&quot;produced in a country during a year, divided by the number of people.&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="s2">&quot;The unit is in purchasing power parities (PPP dollars), fixed to 2017 prices.&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="s2">&quot;Data is adjusted for inflation and differences in the cost of living between countries.&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="p">],</span>
</span>        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">85</span><span class="p">)),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;continent&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">okabe_ito</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">)</span>
<span class="p">)</span>

<span class="hll"><span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">labelFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">titleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_title</span><span class="p">(</span>
</span><span class="hll">    <span class="n">fontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span class="hll">    <span class="n">subtitleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span class="hll">    <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="n">offset</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span class="hll">    <span class="n">subtitleColor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_legend</span><span class="p">(</span>
</span><span class="hll">    <span class="n">titleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span class="hll">    <span class="n">labelFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span class="hll">    <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span class="hll"><span class="p">)</span>
</span>
<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="More tweaking towards a publication-ready figure." src="_images/with-subtitle.svg" />
</figure>
</section>
<section id="interactive-charts">
<h4>Interactive charts<a class="headerlink" href="#interactive-charts" title="Link to this heading"></a></h4>
<p>With not too many changes we can make the chart interactive and add a slider
for the year (please try this in <a class="reference external" href="https://nbviewer.org/github/coderefinery/data-visualization-python/blob/main/notebooks/customizing.ipynb">this
notebook</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">year_slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1952</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">2007</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">slider_selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">year_slider</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="mi">2007</span><span class="p">)</span>
</span>
<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">&quot;How life expectancy and gross domestic product evolved over time&quot;</span><span class="p">,</span>
            <span class="n">subtitle</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;Gross domestic product (GDP) per capita measures the value of everything&quot;</span><span class="p">,</span>
                <span class="s2">&quot;produced in a country during a year, divided by the number of people.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The unit is in purchasing power parities (PPP dollars), fixed to 2017 prices.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Data is adjusted for inflation and differences in the cost of living between countries.&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">85</span><span class="p">)),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;continent&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">okabe_ito</span><span class="p">),</span>
    <span class="p">)</span>
<span class="hll">    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">slider_selection</span><span class="p">)</span>
</span><span class="hll">    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">slider_selection</span><span class="p">)</span>
</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">labelFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">titleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_title</span><span class="p">(</span>
    <span class="n">fontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">subtitleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span>
    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">subtitleColor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_legend</span><span class="p">(</span>
    <span class="n">titleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">labelFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="adding-more-annotation">
<h4>Adding more annotation<a class="headerlink" href="#adding-more-annotation" title="Link to this heading"></a></h4>
<p>With few more lines we can add extra annotation that can help to highlight
certain aspects of the plot and to tell a story:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">year_slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1952</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">2007</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">slider_selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">year_slider</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="mi">2007</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">&quot;How life expectancy and gross domestic product evolved over time&quot;</span><span class="p">,</span>
            <span class="n">subtitle</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;Gross domestic product (GDP) per capita measures the value of everything&quot;</span><span class="p">,</span>
                <span class="s2">&quot;produced in a country during a year, divided by the number of people.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The unit is in purchasing power parities (PPP dollars), fixed to 2017 prices.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Data is adjusted for inflation and differences in the cost of living between countries.&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">85</span><span class="p">)),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;continent&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">okabe_ito</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">slider_selection</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">slider_selection</span><span class="p">)</span>
<span class="p">)</span>

<span class="hll"><span class="n">annotation</span> <span class="o">=</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class="hll">    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span><span class="hll">        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
</span><span class="hll">    <span class="p">)</span>
</span><span class="hll">    <span class="o">.</span><span class="n">transform_filter</span><span class="p">((</span><span class="n">slider_selection</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">country</span> <span class="o">==</span> <span class="s2">&quot;Norway&quot;</span><span class="p">))</span>
</span><span class="hll"><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">chart</span>
</span><span class="hll">    <span class="o">+</span> <span class="n">annotation</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
</span><span class="hll">    <span class="o">+</span> <span class="n">annotation</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">xOffset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="s2">&quot;middle&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="p">)</span>
</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_axis</span><span class="p">(</span><span class="n">labelFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">titleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_title</span><span class="p">(</span>
    <span class="n">fontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">subtitleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span>
    <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">subtitleColor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">configure_legend</span><span class="p">(</span>
    <span class="n">titleFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">labelFontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="Chart with extra annotation." src="_images/with-annotation.svg" />
</figure>
</section>
<section id="saving-the-chart-as-web-page">
<h4>Saving the chart as web page<a class="headerlink" href="#saving-the-chart-as-web-page" title="Link to this heading"></a></h4>
<p>You can save the chart as a web site and try to open it in a separate browser
tab and put it on your home page or research group website:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;chart.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<span id="document-gallery"></span><section id="learning-how-to-adapt-existing-gallery-examples">
<h3>Learning how to adapt existing gallery examples<a class="headerlink" href="#learning-how-to-adapt-existing-gallery-examples" title="Link to this heading"></a></h3>
<p>In this exercise we can try to adapt existing scripts to either <strong>tweak how the
plot looks</strong> or to <strong>modify the input data</strong>.  This is very close to real life:
there are so many options and possibilities and it is almost impossible to
remember everything so this strategy is useful to practice:</p>
<ul class="simple">
<li><p>Select an example that is close to what you have in mind</p></li>
<li><p>Being able to adapt it to your needs</p></li>
<li><p>Being able to search for help</p></li>
</ul>
<div class="admonition-exercise-adapting-a-gallery-example exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Adapting a gallery example</p>
<p><strong>This is a great exercise which is very close to real life.</strong></p>
<ul class="simple">
<li><p>Browse the <a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Vega-Altair example gallery</a>.</p></li>
<li><p>Select one example that is close to your current/recent visualization project
or simply interests you.</p></li>
<li><p>First try to reproduce this example, as-is, in the Jupyter Notebook.</p></li>
<li><p><strong>If you get the error “ModuleNotFoundError: No module named
‘vega_datasets’”, then try one of these examples:</strong> (they do not need the “vega_datasets” module)</p>
<ul>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/slider_cutoff.html">Slider cutoff</a>
(<strong>below you can find a walk-through for this example</strong>)</p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/multiline_tooltip_standard.html">Multi-Line tooltip</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/simple_heatmap.html">Heatmap</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/layered_histogram.html">Layered histogram</a></p></li>
</ul>
</li>
<li><p>Then try to print out the data that is used in this example just before the call of the plotting function
to learn about its structure. Consider writing the data to file before changing it.</p></li>
<li><p>Then try to modify the data a bit.</p></li>
<li><p>If you have time, try to feed it different, simplified data.
<strong>This will be key for adapting the examples to your projects.</strong></p></li>
</ul>
<div class="admonition-example-walk-through-for-the-slider-cutoff-example solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Example walk-through for the slider cutoff example</p>
<p>In this walk-through I imagine browsing: <a class="reference external" href="https://altair-viz.github.io/gallery/index.html">https://altair-viz.github.io/gallery/index.html</a></p>
<p>Then this example caught my eye: <a class="reference external" href="https://altair-viz.github.io/gallery/slider_cutoff.html">https://altair-viz.github.io/gallery/slider_cutoff.html</a></p>
<p>I then copy-paste the example code into a notebook and try to run it and I get
the same result.</p>
<p>Next, there is a lot of code that I don’t (need to) understand yet but my eyes are trying to find
<code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code> which tells me that the data must be the “df” in <code class="docutils literal notranslate"><span class="pre">alt.Chart(df)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;xval&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;yval&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="hll"><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span>    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
<span class="p">)</span>
</pre></div>
</div>
<p>My next step will be to print out the data <code class="docutils literal notranslate"><span class="pre">df</span></code> just before the call to <code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;xval&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;yval&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>The print reveals that <code class="docutils literal notranslate"><span class="pre">df</span></code> is a dataframe which contains x and y values:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>    xval       yval
0      0   0.496714
1      1   0.358450
2      2   1.006138
3      3   2.529168
4      4   2.295015
..   ...        ...
95    95 -10.712354
96    96 -10.416233
97    97 -10.155178
98    98 -10.150065
99    99 -10.384652

[100 rows x 2 columns]
</pre></div>
</div>
<p>The next thing that often helps me is to save the data to a comma-separated
values (CSV) file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>I then open the file in an editor and see that it contains 100 rows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>xval,yval
0,0.4967141530112327
1,0.358449851840048
2,1.0061383899407406
3,2.5291682463487657
4,2.2950148716254297
5,2.060877914676249
6,3.6400907301836405
7,4.407525459336549
8,3.938051073401597
9,4.4806111169875615
...
</pre></div>
</div>
<p>Saving the data to file often helps me to see the structure of the data and now
I am in a position to replace this with my own data. I create a file called
“mydata.csv” and there I use the maximum temperatures for months 1-10 from the
Tromso monthly data which we used further up:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>xval,yval
01,7.7
02,6.6
03,4.5
04,9.8
05,17.7
06,25.4
07,26.7
08,25.1
09,19.3
10,9.8
</pre></div>
</div>
<p>In the notebook I then verify that the reading of the data works:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mydata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>

<span class="n">mydata</span>
</pre></div>
</div>
<p>Now I can replace the example with my own data (note how I now can comment out
some code that I don’t need any longer):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># import numpy as np</span>

<span class="c1"># rand = np.random.RandomState(42)</span>

<span class="c1"># df = pd.DataFrame({</span>
<span class="c1">#     &#39;xval&#39;: range(100),</span>
<span class="c1">#     &#39;yval&#39;: rand.randn(100).cumsum()</span>
<span class="c1"># })</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># print(df)</span>
<span class="hll"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>
</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Seems to work! I then make few more adjustments (I want the slider to work on
the y-axis and have a more reasonable default):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="hll"><span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll"><span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
<span class="hll">        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">yval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
</span>        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>My next steps would then be to change axis titles, display the month names, add
a legend, and refine from here.</p>
</div>
</div>
</section>
<span id="document-sharing"></span><section id="sharing-plots-and-notebooks">
<h3>Sharing plots and notebooks<a class="headerlink" href="#sharing-plots-and-notebooks" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know about good practices for notebooks to make them reusable</p></li>
<li><p>Have a recipe to share a dynamic and reproducible visualization pipeline</p></li>
</ul>
</div>
<p>[this lesson is adapted after <a class="reference external" href="https://coderefinery.github.io/jupyter/sharing/">https://coderefinery.github.io/jupyter/sharing/</a>]</p>
<section id="document-dependencies">
<h4>Document dependencies<a class="headerlink" href="#document-dependencies" title="Link to this heading"></a></h4>
<p>If you import libraries into your notebook, note down their versions.</p>
<p>In Python, it is customary to do this either in a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file (example):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>jupyterlab
altair == 5.5.0
vega_datasets
pandas == 2.2.3
numpy == 2.1.2
</pre></div>
</div>
<p>… or in an <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file (example):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data-viz</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python &lt;= 3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">altair-all = 5.5.0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vega_datasets</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas = 2.2.3</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy = 2.1.2</span>
</pre></div>
</div>
<p>By the way, this is almost the same <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file that we used to install the local software
environment in the <a class="reference internal" href="index.html#installation"><span class="std std-ref">Software install instructions</span></a> (the latter did not pin versions).</p>
<p>Place either <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> in the same folder as the notebook(s).</p>
<p>This is not only useful for people who will try to rerun this in future, it is also
understood by some tools (e.g. <a class="reference external" href="https://mybinder.org/">Binder</a>) which we will see later.</p>
</section>
<section id="different-ways-to-share-a-vega-altair-plot">
<h4>Different ways to share a Vega-Altair plot<a class="headerlink" href="#different-ways-to-share-a-vega-altair-plot" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Save it in SVG format (vector graphics, “maximum resolution”)</p></li>
<li><p>Save it in PNG format (raster graphics)</p></li>
<li><p>Share it as notebook (more about it below)</p></li>
<li><p>Save it a web page with <code class="docutils literal notranslate"><span class="pre">chart.save(&quot;chart.html&quot;)</span></code> and share the HTML file</p></li>
<li><p>You can also get a shareable URL to a chart (<a class="reference external" href="https://altair-viz.github.io/user_guide/saving_charts.html#sharable-url">example</a>)</p></li>
<li><p>With <strong>sensitive data</strong>, you need to be careful with sharing (see next section)</p></li>
</ul>
</section>
<section id="vega-altair-and-notebooks-containing-sensitive-data">
<h4>Vega-Altair and notebooks containing sensitive data<a class="headerlink" href="#vega-altair-and-notebooks-containing-sensitive-data" title="Link to this heading"></a></h4>
<p>If you plot <strong>sensitive data</strong> in a notebook with Vega-Altair,
you need to be careful.</p>
<p>The author of Vega-Altair provided a good summary in this <a class="reference external" href="https://github.com/vega/altair/issues/1250#issuecomment-444269060">GitHub comment</a>:</p>
<blockquote>
<div><p>“Standard Altair rendering requires the entire dataset to be accessible to
the viewer’s browser: this is a fundamental design decision in
Vega/Vega-Lite, in which a chart is equivalent to a dataset plus a
specification of how to render it. In general, you should assume that the
entire contents of any dataframe you pass to the alt.Chart() object will be
saved in the notebook and be inspectable by the viewer.”</p>
</div></blockquote>
<blockquote>
<div><p>“One way to get around this would be to render the chart server-side, export
a PNG, and display this png instead of the live chart. Incidentally, in the
Jupyter notebook you can do this by running:”</p>
</div></blockquote>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">alt.renderers.enable('png')</span></code></p>
</div></blockquote>
<blockquote>
<div><p>“This sets up Altair such that charts will be
rendered to PNG within the kernel, and only that PNG rendering will be
embedded in the notebook. Note this requires some extra dependencies,
described <a class="reference external" href="https://altair-viz.github.io/user_guide/saving_charts.html#png-and-svg-format">here</a>.”</p>
</div></blockquote>
<blockquote>
<div><p>“But even here, I wouldn’t call your data “private” (for example, if you
save a scatter plot to PNG, a user can straightforwardly read the data
values off the chart!) So this makes me think you’re actually doing some
sort of aggregation of your data before plotting (e.g. showing a
histogram). If this is the case, I would suggest doing those aggregations
outside of Altair using e.g. pandas, and then passing the aggregated
dataset to the chart. Then you get the normal interactive display of the
Altair chart, and your data is just as private as it would have been in the
equivalent static rendering – the user can only see the aggregated values
you supplied to the chart.”</p>
</div></blockquote>
</section>
<section id="different-ways-to-share-a-notebook">
<h4>Different ways to share a notebook<a class="headerlink" href="#different-ways-to-share-a-notebook" title="Link to this heading"></a></h4>
<p>We need to learn how to share notebooks. At the minimum we need
to share them with our future selves (backup and reproducibility).</p>
<ul class="simple">
<li><p>You can enter a URL, GitHub repo or username, or GIST ID in <a class="reference external" href="https://nbviewer.jupyter.org/">nbviewer</a> and view a rendered Jupyter notebook</p></li>
<li><p>Read the Docs can render Jupyter Notebooks via the <a class="reference external" href="https://nbsphinx.readthedocs.io/">nbsphinx package</a></p></li>
<li><p><a class="reference external" href="https://mybinder.org/">Binder</a> creates live notebooks based on a GitHub repository</p></li>
<li><p><a class="reference external" href="https://notebooks.egi.eu">EGI Notebooks</a> (see also <a class="reference external" href="https://egi-notebooks.readthedocs.io">https://egi-notebooks.readthedocs.io</a>)</p></li>
<li><p><a class="reference external" href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a> supports sharing and collaborative editing of notebooks via Google Drive. Recently
it also added support for <a class="reference external" href="https://github.com/jupyterlab/jupyterlab/pull/10118">Shared editing with collaborative notebook model</a>.</p></li>
<li><p><a class="reference external" href="https://jupyterlite.readthedocs.io/en/latest/">JupyterLite</a> creates a Jupyterlab environment in the browser and can be hosted as a GitHub page.</p></li>
<li><p><a class="reference external" href="https://github.com/aaren/notedown">Notedown</a>, <a class="reference external" href="https://github.com/QuantEcon/sphinxcontrib-jupyter">Jupinx</a> and <a class="reference external" href="https://github.com/hplgit/doconce">DocOnce</a> can take Markdown or Sphinx files and generate Jupyter Notebooks</p></li>
<li><p><a class="reference external" href="https://voila.readthedocs.io/en/stable/">Voilà</a> allows you to convert a Jupyter Notebook into an interactive dashboard</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">nbconvert</span></code> tool can convert a (<code class="docutils literal notranslate"><span class="pre">.ipynb</span></code>) notebook file to:</p>
<ul>
<li><p>python code (<code class="docutils literal notranslate"><span class="pre">.py</span></code> file)</p></li>
<li><p>an HTML file</p></li>
<li><p>a LaTeX file</p></li>
<li><p>a PDF file</p></li>
<li><p>a slide-show in the browser</p></li>
</ul>
</li>
</ul>
<p>The following platforms can be used free of charge but have <strong>paid subscriptions</strong> for
faster access to cloud resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cocalc.com/">CoCalc</a> (formerly SageMathCloud) allows collaborative editing of notebooks in the cloud</p></li>
<li><p><a class="reference external" href="https://colab.research.google.com/">Google Colab</a> lets you work on notebooks in the cloud, and you can <a class="reference external" href="https://colab.research.google.com/notebooks/io.ipynb">read and write to notebook files on Drive</a></p></li>
<li><p><a class="reference external" href="https://notebooks.azure.com/">Microsoft Azure Notebooks</a> also offers free notebooks in the cloud</p></li>
<li><p><a class="reference external" href="https://deepnote.com/">Deepnote</a> allows real-time collaboration</p></li>
</ul>
</section>
<section id="sharing-dynamic-notebooks-using-binder">
<h4>Sharing dynamic notebooks using <a class="reference external" href="https://mybinder.org/">Binder</a><a class="headerlink" href="#sharing-dynamic-notebooks-using-binder" title="Link to this heading"></a></h4>
<div class="admonition-exercise-demo-making-your-notebooks-reproducible-by-anyone-15-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise/demo: Making your notebooks reproducible by anyone (15 min)</p>
<p>Instructor demonstrates this:</p>
<ul>
<li><p>Instructor creates a <a class="reference external" href="https://github.com/">GitHub</a> repository.</p></li>
<li><p>Uploads a notebook file that we created in earlier episodes.</p></li>
<li><p>Then we look at the statically rendered version of the notebook on GitHub and
also <a class="reference external" href="https://nbviewer.jupyter.org/">nbviewer</a>.</p></li>
<li><p>Add a file <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> which contains:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>altair == 5.5.0
vega_datasets
pandas == 2.2.3
numpy == 2.1.2
</pre></div>
</div>
</li>
<li><p>Visit <a class="reference external" href="https://mybinder.org">https://mybinder.org</a>:</p>
<figure class="align-default">
<img alt="Screenshot from mybinder.org user interface" src="_images/binder.jpg" />
</figure>
</li>
<li><p>Check that your notebook repository now has a “launch binder”
badge in your <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file on GitHub.</p></li>
<li><p>Try clicking the button and see how your repository is launched
on Binder (can take a minute or two). Your notebooks can now be
explored and executed in the cloud.</p></li>
<li><p>Enjoy being fully reproducible!</p></li>
</ul>
</div>
<p>Also please see how we share the notebooks from this lesson
in the <a class="reference internal" href="index.html#episode-overview"><span class="std std-ref">Episode overview</span></a>.</p>
</section>
<section id="how-to-get-a-digital-object-identifier-doi">
<h4>How to get a digital object identifier (DOI)<a class="headerlink" href="#how-to-get-a-digital-object-identifier-doi" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://zenodo.org/">Zenodo</a> is a great service to get a
<a class="reference external" href="https://en.wikipedia.org/wiki/Digital_object_identifier">DOI</a> for a notebook
(but <strong>first practice</strong> with the <a class="reference external" href="https://sandbox.zenodo.org/">Zenodo sandbox</a>).</p></li>
<li><p><a class="reference external" href="https://mybinder.org/">Binder</a> can also run notebooks from Zenodo.</p></li>
<li><p>In the supporting information of your paper you can refer to its DOI.</p></li>
</ul>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-installation"></span><section id="software-install-instructions">
<span id="installation"></span><h3>Software install instructions<a class="headerlink" href="#software-install-instructions" title="Link to this heading"></a></h3>
<p>[this page is adapted from <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/installation/">https://aaltoscicomp.github.io/python-for-scicomp/installation/</a>]</p>
<section id="choosing-an-installation-method">
<h4>Choosing an installation method<a class="headerlink" href="#choosing-an-installation-method" title="Link to this heading"></a></h4>
<p>For this course we will install an isolated environment
with following dependencies:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data-viz</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python &lt;= 3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">altair-all</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vega_datasets</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
</pre></div>
</div>
<p>If you are used to installing packages in Python and know what to do with the
above <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file, please follow your own preferred installation
method.</p>
<p><strong>If you are new to Python or unsure</strong> how to create isolated environments in
Python from files like the <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> above, please follow the
instructions below.</p>
<div class="admonition-there-are-many-choices-and-we-try-to-suggest-a-good-compromise discussion important admonition" id="discussion-0">
<p class="admonition-title">There are many choices and we try to suggest a good compromise</p>
<p>There are very many ways to install Python and packages with pros and cons and
in addition there are several operating systems with their own quirks. This
can be a huge challenge for beginners to navigate. It can also difficult for
instructors to give recommendations for something which will work everywhere
and which everybody will like.</p>
<p>Below we will recommend <strong>Miniforge</strong> since it is free, open source, general,
available on all operating systems, and provides a good basis for reproducible
environments. However, it does not provide a graphical user interface during
installation. This means that every time we want to start a JupyterLab session,
we will have to go through the command line.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Python, conda, anaconda, miniforge, etc?</p>
<p>Unfortunately there are many options and a lot of jargon.
Here is a crash course:</p>
<ul class="simple">
<li><p><strong>Python</strong> is a programming language very commonly used in
science, it’s the topic of this course.</p></li>
<li><p><strong>Conda</strong> is a package manager: it allows distributing and
installing packages, and is designed for complex scientific
code.</p></li>
<li><p><strong>Mamba</strong> is a re-implementation of Conda to be much faster with
resolving dependencies and installing things.</p></li>
<li><p>An <strong>Environment</strong> is a self-contained collections of packages
which can be installed separately from others.  They are used so
each project can install what it needs without affecting others.</p></li>
<li><p><strong>Anaconda</strong> is a commercial distribution of Python+Conda+many
packages that all work together.  It used to be freely usable for
research, but since ~2023-2024 it’s more limited.  Thus, we don’t
recommend it (even though it has a nice graphical user interface).</p></li>
<li><p><strong>conda-forge</strong> is another channel of distributing packages that
is maintained by the community, and thus can be used by anyone.
(Anaconda’s parent company also hosts conda-forge packages)</p></li>
<li><p><strong>miniforge</strong> is a distribution of conda pre-configured for
conda-forge.  It operates via the command line.</p></li>
<li><p><strong>miniconda</strong> is a distribution of conda pre-configured to use
the Anaconda channels.</p></li>
</ul>
</div>
</section>
<section id="installing-python-via-miniforge">
<h4>Installing Python via Miniforge<a class="headerlink" href="#installing-python-via-miniforge" title="Link to this heading"></a></h4>
<p>Follow the <a class="reference external" href="https://github.com/conda-forge/miniforge">instructions on the miniforge web page</a>.  This installs
the base, and from here other packages can be installed.</p>
</section>
<section id="installing-and-activating-the-software-environment">
<h4>Installing and activating the software environment<a class="headerlink" href="#installing-and-activating-the-software-environment" title="Link to this heading"></a></h4>
<p>First we will start Python in a way that activates conda/mamba.  Then we will
install the software environment from <a class="reference external" href="https://raw.githubusercontent.com/coderefinery/data-visualization-python/main/software/environment.yml">this environment.yml
file</a>.</p>
<p>An <strong>environment</strong> is a self-contained set of extra libraries - different
projects can use different environments to not interfere with each other.  This
environment will have all of the software needed for this particular course.</p>
<p>We will call the environment <code class="docutils literal notranslate"><span class="pre">data-viz</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-0-TGludXggLyBNYWNPUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tab" tabindex="-1">Linux / MacOS</button></div><div aria-labelledby="tab-0-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-0-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>Use the “Miniforge Prompt” to start Miniforge.  This
will set up everything so that <code class="docutils literal notranslate"><span class="pre">conda</span></code> and <code class="docutils literal notranslate"><span class="pre">mamba</span></code> are
available.
Then type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>data-viz<span class="w"> </span>-f<span class="w"> </span>https://raw.githubusercontent.com/coderefinery/data-visualization-python/main/software/environment.yml
</pre></div>
</div>
</div><div aria-labelledby="tab-0-TGludXggLyBNYWNPUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tabpanel" tabindex="0"><p>Each time you start a new command line terminal,
you can activate Miniforge by running
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>~/miniforge3/bin/activate
</pre></div>
</div>
<p>This is needed so that
Miniforge is usable wherever you need, but doesn’t affect any
other software on your computer (this is not needed if you
choose “Do you wish to update your shell profile to
automatically initialize conda?”, but then it will always be
active).</p>
<p>In the second step, we will install the software environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>data-viz<span class="w"> </span>-f<span class="w"> </span>https://raw.githubusercontent.com/coderefinery/data-visualization-python/main/software/environment.yml
</pre></div>
</div>
</div></div>
</section>
<section id="starting-jupyterlab">
<h4>Starting JupyterLab<a class="headerlink" href="#starting-jupyterlab" title="Link to this heading"></a></h4>
<p>Every time we want to start a JupyterLab session,
we will have to go through the command line and first
activate the <code class="docutils literal notranslate"><span class="pre">data-viz</span></code> environment.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-1-TGludXggLyBNYWNPUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tab" tabindex="-1">Linux / MacOS</button></div><div aria-labelledby="tab-1-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-1-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>Start the Miniforge Prompt. Then type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>activate<span class="w"> </span>data-viz
<span class="gp">$ </span>jupyter-lab
</pre></div>
</div>
</div><div aria-labelledby="tab-1-TGludXggLyBNYWNPUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tabpanel" tabindex="0"><p>Start the terminal and in the terminal, type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>~/miniforge3/bin/activate
<span class="gp">$ </span>conda<span class="w"> </span>activate<span class="w"> </span>data-viz
<span class="gp">$ </span>jupyter-lab
</pre></div>
</div>
</div></div>
</section>
<section id="removing-the-software-environment">
<h4>Removing the software environment<a class="headerlink" href="#removing-the-software-environment" title="Link to this heading"></a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-2-TGludXggLyBNYWNPUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tab" tabindex="-1">Linux / MacOS</button></div><div aria-labelledby="tab-2-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-2-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>In the Miniforge Prompt, type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>remove<span class="w"> </span>--name<span class="w"> </span>data-viz
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
</pre></div>
</div>
</div><div aria-labelledby="tab-2-TGludXggLyBNYWNPUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tabpanel" tabindex="0"><p>In the terminal, type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>~/miniforge3/bin/activate
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>remove<span class="w"> </span>--name<span class="w"> </span>data-viz
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
</pre></div>
</div>
</div></div>
</section>
<section id="how-to-verify-your-installation">
<h4>How to verify your installation<a class="headerlink" href="#how-to-verify-your-installation" title="Link to this heading"></a></h4>
<p><strong>Start JupyterLab</strong> (as described above).  It will hopefully open up your browser
and look like this:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/testing-jupyter1.png"><img alt="JupyterLab opened in the browser" src="_images/testing-jupyter1.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">JupyterLab opened in the browser. Click on the Python 3 tile.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Once you clicked the Python 3 tile it should look like this:</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/testing-jupyter2.png"><img alt="Python 3 notebook started" src="_images/testing-jupyter2.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Python 3 notebook started.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Into that blue “cell” please type the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;all good - ready for the course&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/testing-jupyter3.png"><img alt="Screenshot where we test to import required libraries." src="_images/testing-jupyter3.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Please copy these lines and click on the “play”/”run” icon.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This is how it should look:</p>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/testing-jupyter4.png"><img alt="Screenshot after successful import." src="_images/testing-jupyter4.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot after successful import.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>If this worked, you are all set and can close JupyterLab (no need to save these
changes).</p>
<p>This is how it <strong>should not</strong> look:</p>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/testing-jupyter5.png"><img alt="Required packages could not be found." src="_images/testing-jupyter5.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Error: required packages could not be found.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<span id="document-colab"></span><section id="going-through-the-course-using-google-colab">
<h3>Going through the course using Google Colab<a class="headerlink" href="#going-through-the-course-using-google-colab" title="Link to this heading"></a></h3>
<p>It is possible to go through the workshop examples using <a class="reference external" href="https://colab.google/">Google Colab</a>.</p>
<p>However you may need the following cell on top of your notebook:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="c1"># this is here for google colab to update altair</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">alt</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;5&quot;</span><span class="p">):</span>
    <span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">altair</span><span class="o">==</span><span class="mf">5.5.0</span>
</pre></div>
</div>
<p>And then you may need to click on “Runtime” -&gt; “Restart session and run all”.</p>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-parsing-custom-format"></span><section id="reading-data-in-custom-format">
<h3>Reading data in custom format<a class="headerlink" href="#reading-data-in-custom-format" title="Link to this heading"></a></h3>
<p>From earlier episodes we know that storing data in standard formats can be
convenient and we know about the tidy data format but <strong>sometimes we don’t have
control over this</strong>: we may get a text file from another program or an
instrument and now we are expected to deal with it.</p>
<p>As an example, we got two text files from two different instruments. We wish to
extract all frequencies and all intensities into two lists.</p>
<p>This is one, <code class="docutils literal notranslate"><span class="pre">example1.txt</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>result from instrument: R2-D2
------------------------------------------

  measurement   frequency   intensity

*     1           0.01       0.01
*     2           0.02       0.02
*     3           0.03       0.01
*     4           0.04       0.10
*     5           0.05       0.20
*     6           0.06       0.12
*     7           0.07       0.07
*     8           0.08       0.02
*     9           0.09       0.01
*    10           0.10       0.01

==========================================

timestamp: Sat Mar 27 03:30:34 PM CET 2021
</pre></div>
</div>
<p>And here is the other one, <code class="docutils literal notranslate"><span class="pre">example2.txt</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>result from instrument: C-3PO
=============================

  numbers we want: 10
      0.01   0.01
      0.02   0.02
      0.03   0.01
      0.04   0.10
      0.05   0.20
      0.06   0.12
      0.07   0.07
      0.08   0.02
      0.09   0.01
      0.10   0.01

  unrelated numbers:
      1.23   4.56
      7.89   0.12
</pre></div>
</div>
<p>At the end we want the code to produce these two lists:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">intensities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>Before we discuss possible solutions, it can be a good exercise
to <strong>describe in words</strong> what the code should do to extract the numbers.</p>
</div>
<p>Below you find possible solutions for these two examples. These are designed to
be somehow understandable (which does not mean that the code is trivial) and are not as
short and as elegant as they could be. One way to make them more elegant would
be to use <a class="reference external" href="https://docs.python.org/3/howto/regex.html">regular expressions</a>.</p>
<p>One solution for <code class="docutils literal notranslate"><span class="pre">example1.txt</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="c1"># we start with empty lists</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">intensities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># open the file with read permissions</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># iterate over all lines in the file object &quot;f&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># we are only interested in lines that start with &quot;*&quot;</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
                <span class="c1"># we split the line on &quot;whitespace&quot;</span>
                <span class="c1"># the &quot;_&quot; means we are not interested in the first two entries</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                <span class="c1"># add the new numbers to the lists</span>
                <span class="c1"># we convert from string to float</span>
                <span class="n">frequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">frequency</span><span class="p">))</span>
                <span class="n">intensities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">intensity</span><span class="p">))</span>

    <span class="c1"># function returns the result</span>
    <span class="k">return</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">intensities</span>


<span class="c1"># here we are outside the function</span>
<span class="n">frequencies</span><span class="p">,</span> <span class="n">intensities</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="s2">&quot;example1.txt&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">intensities</span><span class="p">)</span>
</pre></div>
</div>
<p>One solution for <code class="docutils literal notranslate"><span class="pre">example2.txt</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="c1"># we start with empty lists</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">intensities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># open the file with read permissions</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># iterate over all lines in the file object &quot;f&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># we are only interested in lines that start with &quot;*&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;numbers we want&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># we split the line on &quot;whitespace&quot;</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="c1"># we are only interested in the last element</span>
                <span class="c1"># -1 means last element in that list</span>
                <span class="n">last_element</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># convert from string to int</span>
                <span class="n">num_measurements</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_element</span><span class="p">)</span>

                <span class="c1"># now we know the next 10 lines are the interesting ones</span>
                <span class="c1"># range(10) produces a list with 10 elements: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
                <span class="c1"># we use it to iterate exactly 10 times</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_measurements</span><span class="p">):</span>
                    <span class="c1"># this advances f by one and we get one line at a time</span>
                    <span class="n">next_line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">next_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">frequency</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">intensity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="c1"># add the new numbers to the lists</span>
                    <span class="n">frequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
                    <span class="n">intensities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>

    <span class="c1"># function returns the result</span>
    <span class="k">return</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">intensities</span>


<span class="c1"># here we are outside the function</span>
<span class="n">frequencies</span><span class="p">,</span> <span class="n">intensities</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="s2">&quot;example2.txt&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">intensities</span><span class="p">)</span>
</pre></div>
</div>
</section>
</div>
</section>
<section id="credit">
<h2>Credit<a class="headerlink" href="#credit" title="Link to this heading"></a></h2>
<p>When preparing this lesson, we have reused these resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/">https://aaltoscicomp.github.io/python-for-scicomp/</a></p></li>
<li><p><a class="reference external" href="https://datacarpentry.org/python-ecology-lesson/">https://datacarpentry.org/python-ecology-lesson/</a></p></li>
<li><p><a class="reference external" href="https://swcarpentry.github.io/python-novice-inflammation/">https://swcarpentry.github.io/python-novice-inflammation/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/jupyter/">https://coderefinery.github.io/jupyter/</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>